=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_create_dir.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Simple way to create a file.  Start off with a zero length file, and issue
# 1024 ($count) 1MB appends.

set $dir=/mnt/fuse
set $count=2048
set $iosize=1m
set $nthreads=1
set $sync=false

set mode quit alldone

define file name=largefile,path=$dir,size=0,prealloc

define process name=filecreater,instances=1
{
  thread name=filecreaterthread,memsize=10m,instances=$nthreads
  {
    flowop appendfile name=append-file,filename=largefile,dsync=$sync,iosize=$iosize,directio
    flowop finishoncount name=finish,value=$count
  }
}

run 1000

echo  "FileMicro-Create Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.006: Populating and pre-allocating filesets
0.007: Removing largefile tree (if exists)
0.012: Pre-allocating directories in largefile tree
0.012: Pre-allocating files in largefile tree
0.013: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.013: Population and pre-allocation of filesets completed
0.013: Starting 1 filecreater instances
1.016: Running...
5.017: Run took 4 seconds...
5.017: Per-Operation Breakdown
finish               1024ops      256ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.030ms]
append-file          1025ops      256ops/s 256.0mb/s    2.350ms/op [0.651ms - 4.979ms]
5.017: IO Summary:  1025 ops 256.209 ops/s 0/256 rd/wr 256.0mb/s 2.350ms/op
5.017: Shutting down processes
=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_create.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Simple way to create a file.  Start off with a zero length file, and issue
# 1024 ($count) 1MB appends.

set $dir=/mnt/fuse
set $count=2048
set $iosize=1m
set $nthreads=1
set $sync=false

set mode quit alldone

define file name=largefile,path=$dir,size=0,prealloc

define process name=filecreater,instances=1
{
  thread name=filecreaterthread,memsize=10m,instances=$nthreads
  {
    flowop appendfile name=append-file,filename=largefile,dsync=$sync,iosize=$iosize
    flowop finishoncount name=finish,value=$count
  }
}

run 1000

echo  "FileMicro-Create Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.006: Removing largefile tree (if exists)
0.008: Pre-allocating directories in largefile tree
0.008: Pre-allocating files in largefile tree
0.008: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.008: Population and pre-allocation of filesets completed
0.008: Starting 1 filecreater instances
1.009: Running...
4.010: Run took 3 seconds...
4.010: Per-Operation Breakdown
finish               1024ops      341ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.001ms]
append-file          1025ops      342ops/s 341.3mb/s    1.091ms/op [0.359ms - 37.557ms]
4.010: IO Summary:  1025 ops 341.606 ops/s 0/342 rd/wr 341.3mb/s 1.091ms/op
4.010: Shutting down processes
STAT #1 ----- IO COUNT START -----
Metadata Read  Count: 	9
Metadata write Count: 	5
data     Read  Count: 	8191
data     write Count: 	270335
STAT #1 ----- IO COUNT END -----

=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_createfiles_dir.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Creates a fileset with 20,000 entries ($nfiles), but only preallocates
# 50% of the files.  Each file's size is set via a gamma distribution with
# a median size of 1KB ($filesize).
#
# The single thread then creates a new file and writes the whole file with
# 1MB I/Os.  The thread stops after 5000 files ($count/num of flowops) have
# been created and written to.

set $dir=/mnt/fuse
set $count=20000
set $filesize=1k
set $iosize=1m
set $meandirwidth=100000
set $nfiles=20000
set $nthreads=1

set mode quit alldone

define fileset name=bigfileset,path=$dir,size=$filesize,entries=$nfiles,dirwidth=$meandirwidth,prealloc=50

define process name=filecreate,instances=1
{
  thread name=filecreatethread,memsize=10m,instances=$nthreads
  {
    flowop createfile name=createfile1,filesetname=bigfileset,fd=1
    flowop writewholefile name=writefile1,filesetname=bigfileset,fd=1,iosize=$iosize,directio
    flowop closefile name=closefile1,fd=1
    flowop finishoncount name=finish,value=$count
  }
}

run 1000

echo  "FileMicro-Createfiles Version 2.2 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.011: bigfileset populated: 20000 files, avg. dir. width = 100000, avg. dir. depth = 0.9, 0 leafdirs, 19.531MB total size
0.012: Removing bigfileset tree (if exists)
0.014: Pre-allocating directories in bigfileset tree
0.014: Pre-allocating files in bigfileset tree
0.437: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.437: Population and pre-allocation of filesets completed
0.437: Starting 1 filecreate instances
1.438: Running...
3.439: Run took 2 seconds...
3.439: Per-Operation Breakdown
finish               5001ops     2500ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.001ms]
closefile1           5001ops     2500ops/s   0.0mb/s    0.012ms/op [0.009ms - 0.088ms]
writefile1           5001ops     2500ops/s   2.4mb/s    0.009ms/op [0.007ms - 0.074ms]
createfile1          5001ops     2500ops/s   0.0mb/s    0.033ms/op [0.024ms - 0.379ms]
3.439: IO Summary: 15003 ops 7499.798 ops/s 0/2500 rd/wr   2.4mb/s 0.018ms/op
3.439: Shutting down processes
=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_createfiles.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Creates a fileset with 20,000 entries ($nfiles), but only preallocates
# 50% of the files.  Each file's size is set via a gamma distribution with
# a median size of 1KB ($filesize).
#
# The single thread then creates a new file and writes the whole file with
# 1MB I/Os.  The thread stops after 5000 files ($count/num of flowops) have
# been created and written to.

set $dir=/mnt/fuse
set $count=20000
set $filesize=1k
set $iosize=1m
set $meandirwidth=100000
set $nfiles=20000
set $nthreads=1

set mode quit alldone

define fileset name=bigfileset,path=$dir,size=$filesize,entries=$nfiles,dirwidth=$meandirwidth,prealloc=50

define process name=filecreate,instances=1
{
  thread name=filecreatethread,memsize=10m,instances=$nthreads
  {
    flowop createfile name=createfile1,filesetname=bigfileset,fd=1
    flowop writewholefile name=writefile1,filesetname=bigfileset,fd=1,iosize=$iosize
    flowop closefile name=closefile1,fd=1
    flowop finishoncount name=finish,value=$count
  }
}

run 1000

echo  "FileMicro-Createfiles Version 2.2 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.007: Populating and pre-allocating filesets
0.017: bigfileset populated: 20000 files, avg. dir. width = 100000, avg. dir. depth = 0.9, 0 leafdirs, 19.531MB total size
0.017: Removing bigfileset tree (if exists)
0.019: Pre-allocating directories in bigfileset tree
0.019: Pre-allocating files in bigfileset tree
0.395: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.395: Population and pre-allocation of filesets completed
0.395: Starting 1 filecreate instances
1.396: Running...
3.397: Run took 2 seconds...
3.397: Per-Operation Breakdown
finish               5001ops     2500ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.001ms]
closefile1           5001ops     2500ops/s   0.0mb/s    0.012ms/op [0.009ms - 0.066ms]
writefile1           5001ops     2500ops/s   2.4mb/s    0.009ms/op [0.007ms - 0.180ms]
createfile1          5001ops     2500ops/s   0.0mb/s    0.033ms/op [0.024ms - 0.414ms]
3.397: IO Summary: 15003 ops 7499.756 ops/s 0/2500 rd/wr   2.4mb/s 0.018ms/op
3.397: Shutting down processes
=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_createrand_dir.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded asynchronous ($sync) random appends (random I/Os
# in the range of [1B - 1MB]) to a 1GB file.
# Does a fsync after 10 ($iters) appends.
# Stops after 1GB ($bytes) has been appended/written.

set $dir=/mnt/fuse
set $bytes=1g
set $iosize=1m
set $iters=10
set $nthreads=1
set $sync=false

set mode quit alldone

define file name=largefile,path=$dir,size=0,prealloc

define process name=filecreater,instances=1
{
  thread name=filecreaterthread,memsize=10m,instances=$nthreads
  {
    flowop appendfilerand name=append-file,filename=largefile,dsync=$sync,iosize=$iosize,iters=$iters,directio
    flowop fsync name=sync
    flowop finishonbytes name=finish,value=$bytes
  }
}

run 1000

echo  "FileMicro-CreateRand Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.005: Removing largefile tree (if exists)
0.008: Pre-allocating directories in largefile tree
0.008: Pre-allocating files in largefile tree
0.008: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.008: Population and pre-allocation of filesets completed
0.008: Starting 1 filecreater instances
1.009: Running...
6.009: Run took 5 seconds...
6.010: Per-Operation Breakdown
finish               208ops       42ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.001ms]
sync                 208ops       42ops/s   0.0mb/s    0.005ms/op [0.003ms - 0.148ms]
append-file          2081ops      416ops/s 205.0mb/s    1.803ms/op [0.186ms - 5.359ms]
6.010: IO Summary:  2289 ops 457.756 ops/s 0/416 rd/wr 205.0mb/s 1.640ms/op
6.010: Shutting down processes
STAT #1 ----- IO COUNT START -----
Metadata Read  Count: 	9
Metadata write Count: 	5
data     Read  Count: 	73946
data     write Count: 	271645
STAT #1 ----- IO COUNT END -----

=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_createrand.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded asynchronous ($sync) random appends (random I/Os
# in the range of [1B - 1MB]) to a 1GB file.
# Does a fsync after 10 ($iters) appends.
# Stops after 1GB ($bytes) has been appended/written.

set $dir=/mnt/fuse
set $bytes=1g
set $iosize=1m
set $iters=10
set $nthreads=1
set $sync=false

set mode quit alldone

define file name=largefile,path=$dir,size=0,prealloc

define process name=filecreater,instances=1
{
  thread name=filecreaterthread,memsize=10m,instances=$nthreads
  {
    flowop appendfilerand name=append-file,filename=largefile,dsync=$sync,iosize=$iosize,iters=$iters
    flowop fsync name=sync
    flowop finishonbytes name=finish,value=$bytes
  }
}

run 1000

echo  "FileMicro-CreateRand Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.006: Removing largefile tree (if exists)
0.008: Pre-allocating directories in largefile tree
0.008: Pre-allocating files in largefile tree
0.008: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.008: Population and pre-allocation of filesets completed
0.008: Starting 1 filecreater instances
1.009: Running...
4.009: Run took 3 seconds...
4.010: Per-Operation Breakdown
finish               208ops       69ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.001ms]
sync                 208ops       69ops/s   0.0mb/s    0.003ms/op [0.001ms - 0.081ms]
append-file          2081ops      694ops/s 341.6mb/s    0.568ms/op [0.016ms - 44.625ms]
4.010: IO Summary:  2289 ops 762.911 ops/s 0/694 rd/wr 341.6mb/s 0.516ms/op
4.010: Shutting down processes
=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_rread_dir.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded random reads (2KB I/Os) on a 1GB file.
# Stops after 128MB ($bytes) has been read.

set $dir=/mnt/fuse
set $bytes=128m
set $cached=false
set $filesize=1g
set $iosize=2k
set $iters=1
set $nthreads=1

set mode quit alldone

define file name=bigfile1,path=$dir,size=$filesize,prealloc,reuse

define process name=filereader,instances=1
{
  thread name=filereaderthread,memsize=10m,instances=$nthreads
  {
    flowop read name=write-file,filesetname=bigfile1,random,iosize=$iosize,iters=$iters,directio
    flowop finishonbytes name=finish,value=$bytes
  }
}

run 1000

echo  "FileMicro-ReadRand Version 2.2 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.006: Populating and pre-allocating filesets
0.007: Removing bigfile1 tree (if exists)
0.011: Pre-allocating directories in bigfile1 tree
0.011: Pre-allocating files in bigfile1 tree
1.163: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
1.163: Population and pre-allocation of filesets completed
1.163: Starting 1 filereader instances
2.164: Running...
5.164: Run took 3 seconds...
5.165: Per-Operation Breakdown
finish               65537ops    21841ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.005ms]
write-file           65538ops    21842ops/s  42.7mb/s    0.016ms/op [0.012ms - 70.286ms]
5.165: IO Summary: 65538 ops 21841.712 ops/s 21842/0 rd/wr  42.7mb/s 0.016ms/op
5.165: Shutting down processes
STAT #1 ----- IO COUNT START -----
Metadata Read  Count: 	9
Metadata write Count: 	5
data     Read  Count: 	73728
data     write Count: 	270335
STAT #1 ----- IO COUNT END -----

=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_rread.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded random reads (2KB I/Os) on a 1GB file.
# Stops after 128MB ($bytes) has been read.

set $dir=/mnt/fuse
set $bytes=128m
set $cached=false
set $filesize=1g
set $iosize=2k
set $iters=1
set $nthreads=1

set mode quit alldone

define file name=bigfile1,path=$dir,size=$filesize,prealloc,reuse

define process name=filereader,instances=1
{
  thread name=filereaderthread,memsize=10m,instances=$nthreads
  {
    flowop read name=write-file,filesetname=bigfile1,random,iosize=$iosize,iters=$iters
    flowop finishonbytes name=finish,value=$bytes
  }
}

run 1000

echo  "FileMicro-ReadRand Version 2.2 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.005: Removing bigfile1 tree (if exists)
0.007: Pre-allocating directories in bigfile1 tree
0.008: Pre-allocating files in bigfile1 tree
0.956: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.956: Population and pre-allocation of filesets completed
0.956: Starting 1 filereader instances
1.959: Running...
4.960: Run took 3 seconds...
4.960: Per-Operation Breakdown
finish               65537ops    21841ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.001ms]
write-file           65538ops    21842ops/s  42.7mb/s    0.017ms/op [0.001ms - 76.212ms]
4.960: IO Summary: 65538 ops 21841.537 ops/s 21842/0 rd/wr  42.7mb/s 0.017ms/op
4.960: Shutting down processes
=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_rwrite_dir.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded asynchronous ($sync) random writes (2KB I/Os) on a 1GB file.
# Stops when 128MB ($bytes) has been written.

set $dir=/mnt/fuse
set $bytes=128m
set $cached=false
set $filesize=1g
set $iosize=2k
set $iters=1
set $nthreads=1
set $sync=false

set mode quit alldone

define file name=bigfile1,path=$dir,size=$filesize,prealloc,reuse

define process name=filewriter,instances=1
{
  thread name=filewriterthread,memsize=10m,instances=$nthreads
  {
    flowop write name=write-file,filename=bigfile1,random,dsync=$sync,iosize=$iosize,iters=$iters,directio
    flowop finishonbytes name=finish,value=$bytes
  }
}

run 1000

echo  "FileMicro-WriteRand Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.005: Removing bigfile1 tree (if exists)
0.007: Pre-allocating directories in bigfile1 tree
0.008: Pre-allocating files in bigfile1 tree
0.930: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.930: Population and pre-allocation of filesets completed
0.931: Starting 1 filewriter instances
1.937: Running...
3.937: Run took 2 seconds...
3.937: Per-Operation Breakdown
finish               65537ops    32762ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.012ms]
write-file           65538ops    32763ops/s  64.0mb/s    0.012ms/op [0.008ms - 49.762ms]
3.939: IO Summary: 65538 ops 32762.972 ops/s 0/32763 rd/wr  64.0mb/s 0.012ms/op
3.939: Shutting down processes
STAT #1 ----- IO COUNT START -----
Metadata Read  Count: 	9
Metadata write Count: 	5
data     Read  Count: 	73728
data     write Count: 	335872
STAT #1 ----- IO COUNT END -----

=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_rwritedsync_dir.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded synchronous (O_DSYNC) random writes (2KB I/Os) on a 1GB file.
# Stops when 64K ($count) writes have been done.

set $dir=/mnt/fuse
set $count=131072
set $filesize=1g
set $iosize=2k
set $iters=1
set $nthreads=1

set mode quit alldone

define file name=bigfile,path=$dir,size=$filesize,prealloc,reuse

define process name=filewriter,instances=1
{
  thread name=filewriterthread,memsize=10m,instances=$nthreads
  {
    flowop write name=write-file,filename=bigfile,random,dsync,iosize=$iosize,iters=$iters,directio
    flowop finishoncount name=finish,value=$count
  }
}

run 1000

echo  "FileMicro-WriteRandDsync Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.005: Removing bigfile tree (if exists)
0.008: Pre-allocating directories in bigfile tree
0.008: Pre-allocating files in bigfile tree
0.945: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.945: Population and pre-allocation of filesets completed
0.945: Starting 1 filewriter instances
1.950: Running...
3.950: Run took 2 seconds...
3.950: Per-Operation Breakdown
finish               65536ops    32764ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.001ms]
write-file           65537ops    32765ops/s  64.0mb/s    0.012ms/op [0.009ms - 51.903ms]
3.950: IO Summary: 65537 ops 32764.535 ops/s 0/32765 rd/wr  64.0mb/s 0.012ms/op
3.950: Shutting down processes
STAT #1 ----- IO COUNT START -----
Metadata Read  Count: 	9
Metadata write Count: 	5
data     Read  Count: 	73727
data     write Count: 	335871
STAT #1 ----- IO COUNT END -----

=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_rwritedsync.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded synchronous (O_DSYNC) random writes (2KB I/Os) on a 1GB file.
# Stops when 64K ($count) writes have been done.

set $dir=/mnt/fuse
set $count=131072
set $filesize=1g
set $iosize=2k
set $iters=1
set $nthreads=1

set mode quit alldone

define file name=bigfile,path=$dir,size=$filesize,prealloc,reuse

define process name=filewriter,instances=1
{
  thread name=filewriterthread,memsize=10m,instances=$nthreads
  {
    flowop write name=write-file,filename=bigfile,random,dsync,iosize=$iosize,iters=$iters
    flowop finishoncount name=finish,value=$count
  }
}

run 1000

echo  "FileMicro-WriteRandDsync Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.006: Removing bigfile tree (if exists)
0.008: Pre-allocating directories in bigfile tree
0.008: Pre-allocating files in bigfile tree
0.942: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.942: Population and pre-allocation of filesets completed
0.942: Starting 1 filewriter instances
1.950: Running...
3.951: Run took 2 seconds...
3.951: Per-Operation Breakdown
finish               65536ops    32762ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.004ms]
write-file           65537ops    32762ops/s  64.0mb/s    0.013ms/op [0.009ms - 49.718ms]
3.951: IO Summary: 65537 ops 32762.373 ops/s 0/32762 rd/wr  64.0mb/s 0.013ms/op
3.951: Shutting down processes
STAT #1 ----- IO COUNT START -----
Metadata Read  Count: 	9
Metadata write Count: 	5
data     Read  Count: 	73727
data     write Count: 	335871
STAT #1 ----- IO COUNT END -----

=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_rwrite.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded asynchronous ($sync) random writes (2KB I/Os) on a 1GB file.
# Stops when 128MB ($bytes) has been written.

set $dir=/mnt/fuse
set $bytes=128m
set $cached=false
set $filesize=1g
set $iosize=2k
set $iters=1
set $nthreads=1
set $sync=false

set mode quit alldone

define file name=bigfile1,path=$dir,size=$filesize,prealloc,reuse

define process name=filewriter,instances=1
{
  thread name=filewriterthread,memsize=10m,instances=$nthreads
  {
    flowop write name=write-file,filename=bigfile1,random,dsync=$sync,iosize=$iosize,iters=$iters
    flowop finishonbytes name=finish,value=$bytes
  }
}

run 1000

echo  "FileMicro-WriteRand Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.007: Populating and pre-allocating filesets
0.008: Removing bigfile1 tree (if exists)
0.014: Pre-allocating directories in bigfile1 tree
0.015: Pre-allocating files in bigfile1 tree
0.994: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.994: Population and pre-allocation of filesets completed
0.995: Starting 1 filewriter instances
1.996: Running...
3.996: Run took 2 seconds...
3.996: Per-Operation Breakdown
finish               65537ops    32762ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.001ms]
write-file           65538ops    32762ops/s  64.0mb/s    0.013ms/op [0.009ms - 70.018ms]
3.996: IO Summary: 65538 ops 32762.300 ops/s 0/32762 rd/wr  64.0mb/s 0.013ms/op
3.996: Shutting down processes
STAT #1 ----- IO COUNT START -----
Metadata Read  Count: 	9
Metadata write Count: 	5
data     Read  Count: 	73728
data     write Count: 	335872
STAT #1 ----- IO COUNT END -----

=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_rwritefsync_dir.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded asynchronous random writes (8KB I/Os) on a 1GB file.
# A fsync is issued after 16K ($iters) worth of writes.
# Stops after one ($count) fsync.

set $dir=/mnt/fuse
set $cached=false
set $count=1
set $filesize=1g
set $iosize=8k
set $iters=16384
set $nthreads=1

set mode quit alldone

define file name=bigfile,path=$dir,size=$filesize,prealloc

define process name=filewriter,instances=1
{
  thread name=filewriterthread,memsize=10m,instances=$nthreads
  {
    flowop write name=write-file,filename=bigfile,random,iosize=$iosize,iters=$iters,directio
    flowop fsync name=sync-file
    flowop finishoncount name=finish,value=$count
  }
}

run 1000

echo  "FileMicro-WriteRandFsync Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.005: Removing bigfile tree (if exists)
0.007: Pre-allocating directories in bigfile tree
0.008: Pre-allocating files in bigfile tree
1.236: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
1.236: Population and pre-allocation of filesets completed
1.236: Starting 1 filewriter instances
2.237: Running...
4.237: Run took 2 seconds...
4.237: Per-Operation Breakdown
finish               1ops        0ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.000ms]
sync-file            1ops        0ops/s   0.0mb/s    0.011ms/op [0.011ms - 0.011ms]
write-file           16385ops     8192ops/s  64.0mb/s    0.021ms/op [0.014ms - 48.612ms]
4.237: IO Summary: 16386 ops 8192.082 ops/s 0/8192 rd/wr  64.0mb/s 0.021ms/op
4.237: Shutting down processes
STAT #1 ----- IO COUNT START -----
Metadata Read  Count: 	9
Metadata write Count: 	5
data     Read  Count: 	57343
data     write Count: 	319487
STAT #1 ----- IO COUNT END -----

=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_rwritefsync.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded asynchronous random writes (8KB I/Os) on a 1GB file.
# A fsync is issued after 16K ($iters) worth of writes.
# Stops after one ($count) fsync.

set $dir=/mnt/fuse
set $cached=false
set $count=1
set $filesize=1g
set $iosize=8k
set $iters=16384
set $nthreads=1

set mode quit alldone

define file name=bigfile,path=$dir,size=$filesize,prealloc

define process name=filewriter,instances=1
{
  thread name=filewriterthread,memsize=10m,instances=$nthreads
  {
    flowop write name=write-file,filename=bigfile,random,iosize=$iosize,iters=$iters
    flowop fsync name=sync-file
    flowop finishoncount name=finish,value=$count
  }
}

run 1000

echo  "FileMicro-WriteRandFsync Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.006: Populating and pre-allocating filesets
0.006: Removing bigfile tree (if exists)
0.008: Pre-allocating directories in bigfile tree
0.008: Pre-allocating files in bigfile tree
0.953: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.953: Population and pre-allocation of filesets completed
0.953: Starting 1 filewriter instances
1.956: Running...
3.956: Run took 2 seconds...
3.956: Per-Operation Breakdown
finish               1ops        0ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.000ms]
sync-file            1ops        0ops/s   0.0mb/s    0.012ms/op [0.012ms - 0.012ms]
write-file           16385ops     8191ops/s  64.0mb/s    0.023ms/op [0.016ms - 49.210ms]
3.957: IO Summary: 16386 ops 8191.534 ops/s 0/8191 rd/wr  64.0mb/s 0.023ms/op
3.957: Shutting down processes
=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_seqread_dir.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded sequential reads (1MB I/Os) on a 1G file.

set $dir=/mnt/fuse
set $cached=false
set $filesize=1g
set $iosize=1m
set $nthreads=1

set mode quit alldone

define file name=largefile,path=$dir,size=$filesize,prealloc,reuse

define process name=filereader,instances=1
{
  thread name=filereaderthread,memsize=10m,instances=$nthreads
  {
    flowop read name=seqread-file,filename=largefile,iosize=$iosize,directio
    flowop finishonbytes name=finish,value=$filesize
  }
}

run 1000

echo  "FileMicro-SeqRead Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.005: Removing largefile tree (if exists)
0.008: Pre-allocating directories in largefile tree
0.008: Pre-allocating files in largefile tree
1.033: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
1.033: Population and pre-allocation of filesets completed
1.033: Starting 1 filereader instances
2.034: Running...
4.035: Run took 2 seconds...
4.035: Per-Operation Breakdown
finish               1026ops      513ops/s   0.0mb/s    0.000ms/op [0.001ms - 0.001ms]
seqread-file         1027ops      513ops/s 512.4mb/s    0.556ms/op [0.007ms - 78.322ms]
4.035: IO Summary:  1027 ops 513.380 ops/s 513/0 rd/wr 512.4mb/s 0.556ms/op
4.035: Shutting down processes
=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_seqread.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded sequential reads (1MB I/Os) on a 1G file.

set $dir=/mnt/fuse
set $cached=false
set $filesize=1g
set $iosize=1m
set $nthreads=1

set mode quit alldone

define file name=largefile,path=$dir,size=$filesize,prealloc,reuse

define process name=filereader,instances=1
{
  thread name=filereaderthread,memsize=10m,instances=$nthreads
  {
    flowop read name=seqread-file,filename=largefile,iosize=$iosize
    flowop finishonbytes name=finish,value=$filesize
  }
}

run 1000

echo  "FileMicro-SeqRead Version 2.1 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.006: Removing largefile tree (if exists)
0.008: Pre-allocating directories in largefile tree
0.008: Pre-allocating files in largefile tree
0.940: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.940: Population and pre-allocation of filesets completed
0.940: Starting 1 filereader instances
1.952: Running...
3.952: Run took 2 seconds...
3.953: Per-Operation Breakdown
finish               1026ops      513ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.001ms]
seqread-file         1027ops      513ops/s 512.4mb/s    0.471ms/op [0.016ms - 49.782ms]
3.953: IO Summary:  1027 ops 513.361 ops/s 513/0 rd/wr 512.4mb/s 0.471ms/op
3.953: Shutting down processes
STAT #1 ----- IO COUNT START -----
Metadata Read  Count: 	9
Metadata write Count: 	5
data     Read  Count: 	278526
data     write Count: 	270335
STAT #1 ----- IO COUNT END -----

=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_seqwrite_dir.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded asynchronous ($sync) sequential writes (1MB I/Os) to
# a 1GB file.
# Stops after 1 series of 1024 ($count) writes has been done.

set $dir=/mnt/fuse
set $cached=false
set $count=1024
set $iosize=1m
set $nthreads=1
set $sync=false

set mode quit alldone

define file name=bigfile,path=$dir,size=0,prealloc

define process name=filewriter,instances=1
{
  thread name=filewriterthread,memsize=10m,instances=$nthreads
  {
    flowop appendfile name=write-file,dsync=$sync,filename=bigfile,iosize=$iosize,iters=$count,directio
    flowop finishoncount name=finish,value=1
  }
}

run 1000

echo  "FileMicro-SeqWrite Version 2.2 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.005: Removing bigfile tree (if exists)
0.007: Pre-allocating directories in bigfile tree
0.008: Pre-allocating files in bigfile tree
0.008: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.008: Population and pre-allocation of filesets completed
0.008: Starting 1 filewriter instances
1.009: Running...
6.010: Run took 5 seconds...
6.010: Per-Operation Breakdown
finish               1ops        0ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.000ms]
write-file           1025ops      205ops/s 204.8mb/s    3.183ms/op [0.361ms - 10.253ms]
6.010: IO Summary:  1025 ops 204.965 ops/s 0/205 rd/wr 204.8mb/s 3.183ms/op
6.010: Shutting down processes
=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_seqwrite.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single threaded asynchronous ($sync) sequential writes (1MB I/Os) to
# a 1GB file.
# Stops after 1 series of 1024 ($count) writes has been done.

set $dir=/mnt/fuse
set $cached=false
set $count=1024
set $iosize=1m
set $nthreads=1
set $sync=false

set mode quit alldone

define file name=bigfile,path=$dir,size=0,prealloc

define process name=filewriter,instances=1
{
  thread name=filewriterthread,memsize=10m,instances=$nthreads
  {
    flowop appendfile name=write-file,dsync=$sync,filename=bigfile,iosize=$iosize,iters=$count
    flowop finishoncount name=finish,value=1
  }
}

run 1000

echo  "FileMicro-SeqWrite Version 2.2 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.006: Populating and pre-allocating filesets
0.006: Removing bigfile tree (if exists)
0.008: Pre-allocating directories in bigfile tree
0.008: Pre-allocating files in bigfile tree
0.008: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.008: Population and pre-allocation of filesets completed
0.008: Starting 1 filewriter instances
1.010: Running...
4.010: Run took 3 seconds...
4.010: Per-Operation Breakdown
finish               1ops        0ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.000ms]
write-file           1025ops      342ops/s 341.3mb/s    1.056ms/op [0.650ms - 9.606ms]
4.010: IO Summary:  1025 ops 341.614 ops/s 0/342 rd/wr 341.3mb/s 1.056ms/op
4.010: Shutting down processes
STAT #1 ----- IO COUNT START -----
Metadata Read  Count: 	9
Metadata write Count: 	5
data     Read  Count: 	8191
data     write Count: 	270335
STAT #1 ----- IO COUNT END -----

=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_writefsync_dir.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single-threaded writes to initially empty file.
# I/O size is set to 8KB. After every 1024 writes 
# (i.e., 8MB written) fsync is called.
# The run finishes after 1GB is fully written.

set $dir=/mnt/fuse
set $iosize=8k
set $writeiters=1024
set $fsynccount=128

set mode quit alldone

define file name=bigfile,path=$dir,size=0,prealloc

define process name=filewriter,instances=1
{
  thread name=filewriterthread,memsize=10m,instances=1
  {
    flowop appendfile name=append-file,filename=bigfile,iosize=$iosize,iters=$writeiters,directio
    flowop fsync name=sync-file
    flowop finishoncount name=finish,value=128,target=sync-file
  }
}

run 1000

echo  "FileMicro-WriteFsync Version 2.1 personality successfully loaded"

run
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.006: Removing bigfile tree (if exists)
0.008: Pre-allocating directories in bigfile tree
0.008: Pre-allocating files in bigfile tree
0.008: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.008: Population and pre-allocation of filesets completed
0.008: Starting 1 filewriter instances
1.009: Running...
5.009: Run took 4 seconds...
5.009: Per-Operation Breakdown
finish               128ops       32ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.001ms]
sync-file            128ops       32ops/s   0.0mb/s    0.002ms/op [0.001ms - 0.014ms]
append-file          131073ops    32765ops/s 256.0mb/s    0.022ms/op [0.019ms - 2.722ms]
5.010: IO Summary: 131201 ops 32796.741 ops/s 0/32765 rd/wr 256.0mb/s 0.022ms/op
5.010: Shutting down processes
STAT #1 ----- IO COUNT START -----
Metadata Read  Count: 	9
Metadata write Count: 	5
data     Read  Count: 	131071
data     write Count: 	393215
STAT #1 ----- IO COUNT END -----

=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/filemicro_writefsync.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# ident	"%Z%%M%	%I%	%E% SMI"

# Single-threaded writes to initially empty file.
# I/O size is set to 8KB. After every 1024 writes 
# (i.e., 8MB written) fsync is called.
# The run finishes after 1GB is fully written.

set $dir=/mnt/fuse
set $iosize=8k
set $writeiters=1024
set $fsynccount=128

set mode quit alldone

define file name=bigfile,path=$dir,size=0,prealloc

define process name=filewriter,instances=1
{
  thread name=filewriterthread,memsize=10m,instances=1
  {
    flowop appendfile name=append-file,filename=bigfile,iosize=$iosize,iters=$writeiters
    flowop fsync name=sync-file
    flowop finishoncount name=finish,value=128,target=sync-file
  }
}

run 1000

echo  "FileMicro-WriteFsync Version 2.1 personality successfully loaded"

run
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.006: Populating and pre-allocating filesets
0.006: Removing bigfile tree (if exists)
0.008: Pre-allocating directories in bigfile tree
0.008: Pre-allocating files in bigfile tree
0.009: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.009: Population and pre-allocation of filesets completed
0.009: Starting 1 filewriter instances
1.010: Running...
6.010: Run took 5 seconds...
6.010: Per-Operation Breakdown
finish               128ops       26ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.001ms]
sync-file            128ops       26ops/s   0.0mb/s    0.003ms/op [0.001ms - 0.016ms]
append-file          131073ops    26212ops/s 204.8mb/s    0.024ms/op [0.019ms - 15.971ms]
6.010: IO Summary: 131201 ops 26237.450 ops/s 0/26212 rd/wr 204.8mb/s 0.024ms/op
6.010: Shutting down processes
=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/makedirs.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# Creates a directory with $ndirs potential leaf directories, than mkdir's them
#
set $dir=/mnt/fuse
set $ndirs=10000
set $meandirwidth=100
set $nthreads=1

set mode quit firstdone

define fileset name=bigfileset,path=$dir,size=0,leafdirs=$ndirs,dirwidth=$meandirwidth

define process name=dirmake,instances=1
{
  thread name=dirmaker,memsize=1m,instances=$nthreads
  {
    flowop makedir name=mkdir1,filesetname=bigfileset
  }
}

run 1000

echo  "MakeDirs Version 1.0 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.006: Populating and pre-allocating filesets
0.008: bigfileset populated: 0 files, avg. dir. width = 100, avg. dir. depth = 2.0, 10000 leafdirs, 0.000MB total size
0.008: Removing bigfileset tree (if exists)
0.010: Pre-allocating directories in bigfileset tree
0.014: Pre-allocating files in bigfileset tree
0.018: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
0.018: Population and pre-allocation of filesets completed
0.018: Starting 1 dirmake instances
1.019: Running...
2.019: Run took 1 seconds...
2.019: Per-Operation Breakdown
mkdir1               10000ops     9999ops/s   0.0mb/s    0.029ms/op [0.015ms - 3.372ms]
2.019: IO Summary: 10000 ops 9998.720 ops/s 0/0 rd/wr   0.0mb/s 0.029ms/op
2.019: Shutting down processes
=============================================================================================
/home/koo/src/koofs/benchmark/filebench/workloads/used/openfiles.f
#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#
#
# Copyright 2008 Sun Microsystems, Inc.  All rights reserved.
# Use is subject to license terms.
#
# Creates a fileset with $nfiles empty files, then proceeds to open each one
# and then close it.
#
set $dir=/mnt/fuse
set $nfiles=50000
set $meandirwidth=100
set $nthreads=1

set mode quit firstdone

define fileset name=bigfileset,path=$dir,size=0,entries=$nfiles,dirwidth=$meandirwidth,prealloc

define process name=fileopen,instances=1
{
  thread name=fileopener,memsize=1m,instances=$nthreads
  {
    flowop openfile name=open1,filesetname=bigfileset,fd=1
    flowop closefile name=close1,fd=1
  }
}

run 1000

echo  "Openfiles Version 1.0 personality successfully loaded"
Filebench Version 1.5-alpha3
0.000: Allocated 173MB of shared memory
0.005: Populating and pre-allocating filesets
0.019: bigfileset populated: 50000 files, avg. dir. width = 100, avg. dir. depth = 2.3, 0 leafdirs, 0.000MB total size
0.019: Removing bigfileset tree (if exists)
0.021: Pre-allocating directories in bigfileset tree
0.038: Pre-allocating files in bigfileset tree
1.818: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
1.818: Population and pre-allocation of filesets completed
1.819: Starting 1 fileopen instances
2.822: Running...
510.608: Aborting...
